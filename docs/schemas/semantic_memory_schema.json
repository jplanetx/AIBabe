{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Pinecone Vector Metadata Schema for Semantic Memory",
  "description": "Defines the structure of metadata stored alongside vectors in Pinecone for user facts and preferences.",
  "type": "object",
  "properties": {
    "vectorId": {
      "description": "Unique identifier for the vector, corresponding to the ID from the Prisma UserFact or UserSemanticPreference model.",
      "type": "string"
    },
    "userId": {
      "description": "Identifier of the user to whom this fact or preference belongs.",
      "type": "string"
    },
    "timestamp": {
      "description": "ISO 8601 formatted timestamp indicating when the fact/preference was created or last updated.",
      "type": "string",
      "format": "date-time"
    },
    "type": {
      "description": "The type of semantic memory item.",
      "type": "string",
      "enum": ["fact", "preference"]
    },
    "text": {
      "description": "The original text content of the fact or the value of the preference.",
      "type": "string"
    },
    "preferenceType": {
      "description": "Specific type of preference (e.g., TONE, TOPIC_AVOIDANCE). Only applicable if 'type' is 'preference'.",
      "type": "string",
      "enum": ["TONE", "TOPIC_AVOIDANCE", "INFO_DEPTH"]
    }
  },
  "required": [
    "vectorId",
    "userId",
    "timestamp",
    "type",
    "text"
  ],
  "if": {
    "properties": { "type": { "const": "preference" } }
  },
  "then": {
    "required": ["preferenceType"]
  }
}