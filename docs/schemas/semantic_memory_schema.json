{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Pinecone Vector Metadata Schema for Semantic Memory",
  "description": "Defines the structure of metadata stored alongside vectors in Pinecone for user facts and preferences.",
  "type": "object",
  "properties": {
    "vectorId": {
      "description": "Unique identifier for the vector, corresponding to the ID from the Prisma UserFact or UserSemanticPreference model.",
      "type": "string"
    },
    "userId": {
      "description": "Identifier of the user to whom this fact or preference belongs.",
      "type": "string"
    },
    "factText": {
      "description": "The original text content of the fact. Only applicable if 'type' is 'fact'.",
      "type": "string"
    },
    "preferenceValue": {
      "description": "The value of the preference. Only applicable if 'type' is 'preference'.",
      "type": "string"
    },
    "preferenceType": {
      "description": "Specific type of preference (e.g., TONE, TOPIC_AVOIDANCE, INFO_DEPTH). Only applicable if 'type' is 'preference'.",
      "type": "string",
      "enum": ["TONE", "TOPIC_AVOIDANCE", "INFO_DEPTH"]
    },
    "sourceSessionId": {
      "description": "Optional identifier of the session where the fact or preference was learned/set.",
      "type": "string"
    },
    "createdAt": {
      "description": "ISO 8601 formatted timestamp indicating when the fact/preference was created.",
      "type": "string",
      "format": "date-time"
    },
    "updatedAt": {
      "description": "ISO 8601 formatted timestamp indicating when the fact/preference was last updated.",
      "type": "string",
      "format": "date-time"
    },
    "type": {
      "description": "The type of semantic memory item.",
      "type": "string",
      "enum": ["fact", "preference"]
    }
  },
  "required": [
    "vectorId",
    "userId",
    "type"
  ],
  "if": {
    "properties": { "type": { "const": "preference" } }
  },
  "then": {
    "required": ["preferenceType", "preferenceValue"]
  },
   "else": {
    "required": ["factText"]
  }
}